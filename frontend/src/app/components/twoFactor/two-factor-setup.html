<div class="two-factor-setup">
      <h3>üîê Authentification √† Deux Facteurs</h3>
      
      <div *ngIf="!isSetupCompleted" class="setup-container">
        <!-- √âtape 1 : G√©n√©ration QR Code -->
        <div *ngIf="!qrCodeData" class="step step-1">
          <p>Activez l'authentification √† deux facteurs pour renforcer la s√©curit√© de votre compte.</p>
          <button class="btn btn-primary" (click)="startSetup()" [disabled]="isLoading">
            {{ isLoading ? 'G√©n√©ration...' : 'Commencer la configuration' }}
          </button>
        </div>

        <!-- √âtape 2 : Scan QR Code -->
        <div *ngIf="qrCodeData && !isVerified" class="step step-2">
          <h4>√âtape 1 : Scannez le QR Code</h4>
          <div class="qr-container">
            <img [src]="qrCodeData.qrCodeUrl" alt="QR Code 2FA" class="qr-code">
          </div>
          <p class="instruction">
            Scannez ce QR Code avec Google Authenticator ou une application similaire.
          </p>

          <h4>√âtape 2 : Entrez le code de v√©rification</h4>
          <div class="verification-form">
            <input 
              type="text" 
              [(ngModel)]="verificationCode" 
              placeholder="Entrez le code √† 6 chiffres"
              maxlength="6"
              class="code-input"
              [class.error]="verificationError"
            >
            <button 
              class="btn btn-success" 
              (click)="verifyCode()"
              [disabled]="!verificationCode || verificationCode.length !== 6 || isLoading"
            >
              {{ isLoading ? 'V√©rification...' : 'V√©rifier' }}
            </button>
          </div>

          <div *ngIf="verificationError" class="error-message">
            ‚ùå Code invalide. Veuillez r√©essayer.
          </div>
        </div>
      </div>

      <!-- √âtape 3 : Configuration r√©ussie -->
      <div *ngIf="isSetupCompleted" class="step step-3 success">
        <div class="success-icon">‚úÖ</div>
        <h4>2FA Activ√© avec Succ√®s !</h4>
        <p>L'authentification √† deux facteurs est maintenant activ√©e pour votre compte.</p>
        
        <div *ngIf="backupCode" class="backup-code">
          <strong>Code de secours :</strong>
          <code class="backup-code-display">{{ backupCode }}</code>
          <small>Conservez ce code en lieu s√ªr. Il vous permettra d'acc√©der √† votre compte si vous perdez votre t√©l√©phone.</small>
        </div>

        <button class="btn btn-secondary" (click)="onComplete.emit()">
          Terminer
        </button>
      </div>
    </div>
