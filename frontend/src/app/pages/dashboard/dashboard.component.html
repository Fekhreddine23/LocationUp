<app-breadcrumbs [items]="breadcrumbItems"></app-breadcrumbs>

 

<div class="dashboard-container">
  <!-- En-t√™te -->
  <div class="dashboard-header">
    <h1>Tableau de Bord</h1>
    <p class="welcome-message" *ngIf="user">
      Bonjour, <strong>{{ user.username }}</strong> ! üëã
    </p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <app-spinner text="Chargement de votre tableau de bord..."></app-spinner>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    ‚ùå {{ errorMessage }}
  </div>

  <!-- Contenu du Dashboard -->
  <div *ngIf="!isLoading && user" class="dashboard-content">
    
    <!-- Section Actions Rapides -->
    <div class="dashboard-section">
      <h2>Actions Rapides</h2>
      <div class="quick-actions-grid">
        <button class="quick-action-card" (click)="createNewBooking()">
          <div class="action-icon">‚ûï</div>
          <div class="action-title">Nouvelle R√©servation</div>
          <div class="action-description">R√©server un v√©hicule</div>
        </button>

        <button class="quick-action-card" (click)="goToBookings()">
          <div class="action-icon">üìã</div>
          <div class="action-title">Mes R√©servations</div>
          <div class="action-description">Voir toutes mes r√©servations</div>
        </button>

        <button class="quick-action-card" (click)="goToOffers()">
          <div class="action-icon">üöó</div>
          <div class="action-title">Offres Disponibles</div>
          <div class="action-description">Parcourir les v√©hicules</div>
        </button>

        <button class="quick-action-card" (click)="goToProfile()">
          <div class="action-icon">üë§</div>
          <div class="action-title">Mon Profil</div>
          <div class="action-description">G√©rer mes informations</div>
        </button>
      </div>
    </div>

    <!-- Section Statistiques -->
    <div class="dashboard-section">
      <h2>Vue d'Ensemble</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">üìä</div>
          <div class="stat-content">
            <div class="stat-number">{{ userStats.totalBookings }}</div>
            <div class="stat-label">R√©servations Totales</div>
          </div>
        </div>

        <div class="stat-card stat-active">
          <div class="stat-icon">üü¢</div>
          <div class="stat-content">
            <div class="stat-number">{{ userStats.activeBookings }}</div>
            <div class="stat-label">R√©servations Actives</div>
          </div>
        </div>

        <div class="stat-card stat-completed">
          <div class="stat-icon">‚úÖ</div>
          <div class="stat-content">
            <div class="stat-number">{{ userStats.completedBookings }}</div>
            <div class="stat-label">R√©servations Termin√©es</div>
          </div>
        </div>

        <div class="stat-card stat-cancelled">
          <div class="stat-icon">‚ùå</div>
          <div class="stat-content">
            <div class="stat-number">{{ userStats.cancelledBookings }}</div>
            <div class="stat-label">R√©servations Annul√©es</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Section Favoris r√©cents -->
    <div class="dashboard-section favorites-section">
      <div class="section-header">
        <h2>Vos favoris r√©cents</h2>
        <button class="btn btn-outline btn-sm" (click)="goToFavorites()">
          Voir mes favoris ‚Üí
        </button>
      </div>

      <div *ngIf="favoriteError" class="alert alert-warning">
        ‚ö†Ô∏è {{ favoriteError }}
      </div>

      <ng-container *ngIf="favoritesLoading; else favoritesContent">
        <div class="favorites-skeleton">
          <div class="skeleton-card" *ngFor="let _ of [1,2,3]">
            <div class="skeleton-line shimmer"></div>
            <div class="skeleton-line shimmer short"></div>
          </div>
        </div>
      </ng-container>

      <ng-template #favoritesContent>
        <div *ngIf="favoriteOffers.length > 0; else noFavorites" class="favorite-grid">
          <div class="favorite-card" *ngFor="let offer of favoritePreview">
            <div class="favorite-header">
              <span class="favorite-location">{{ offer.pickupLocationName }}</span>
              <span class="favorite-service">{{ offer.mobilityService || offer.mobilityServiceName }}</span>
            </div>
            <p class="favorite-title">{{ offer.description }}</p>
            <div class="favorite-footer">
              <div class="favorite-price">
                {{ offer.price | number:'1.0-0' }} ‚Ç¨
              </div>
              <button class="btn btn-primary btn-xs" (click)="exploreOffers()">
                Voir l'offre
              </button>
            </div>
          </div>
        </div>
      </ng-template>

      <ng-template #noFavorites>
        <div class="favorite-empty">
          <div class="empty-icon">‚≠ê</div>
          <p>Ajoutez vos offres pr√©f√©r√©es pour les retrouver ici rapidement.</p>
          <button class="btn btn-outline" (click)="exploreOffers()">Explorer les offres</button>
        </div>
      </ng-template>
    </div>

    <!-- Section R√©servations R√©centes -->
    <div class="dashboard-section" *ngIf="recentBookings.length > 0">
      <div class="section-header">
        <h2>R√©servations R√©centes</h2>
        <button class="btn btn-outline btn-sm" (click)="goToBookings()">
          Voir tout ‚Üí
        </button>
      </div>
      
      <div class="recent-bookings">
        <div *ngFor="let booking of recentBookings" class="recent-booking-card">
          <div class="booking-info">
            <div class="booking-id">#{{ booking.reservationId }}</div>
            <div class="booking-date">{{ formatDate(booking.reservationDate) }}</div>
          </div>
          <div class="booking-status">
            <span [class]="'status-badge ' + getStatusClass(booking.status)">
              {{ getStatusText(booking.status) }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Message si pas de r√©servations -->
    <div *ngIf="recentBookings.length === 0" class="empty-state">
      <div class="empty-icon">üìã</div>
      <h3>Aucune r√©servation</h3>
      <p>Vous n'avez pas encore de r√©servation.</p>
      <button class="btn btn-primary" (click)="createNewBooking()">
        Cr√©er ma premi√®re r√©servation
      </button>
    </div>

  </div>
</div>
